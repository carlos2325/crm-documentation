<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📋 CRM - Sistema de Gestión de Relaciones con Clientes</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="nav-brand">
                <i class="fas fa-users-cog"></i>
                <span>CRM Marketing Soluciones</span>
            </div>
            <div class="nav-menu" id="nav-menu">
                <a href="#home" class="nav-link active">🏠 Home</a>
                <a href="#api" class="nav-link">🔌 API GraphQL</a>
                <a href="#frontend" class="nav-link">💻 Frontend</a>
                <a href="#campaigns" class="nav-link">📧 Campañas</a>
                <a href="#events" class="nav-link">🎉 Eventos</a>
                <a href="#permissions" class="nav-link">🔐 Permisos</a>
                <a href="#complete-systems" class="nav-link">🎯 Sistemas</a>
                <a href="#examples" class="nav-link">📝 Ejemplos</a>
                <a href="#deployment" class="nav-link">🚀 Deployment</a>
                <a href="#monitoring" class="nav-link">📊 Monitoreo</a>
                <a href="#monitoring-detailed" class="nav-link">🔔 Alertas</a>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Home Section -->
        <section id="home" class="section">
            <div class="container">
                <h1 class="section-title">
                    <i class="fas fa-users-cog"></i>
                    Sistema CRM Completo - Marketing Soluciones
                </h1>
                <p class="section-subtitle">
                    Documentación técnica completa para desarrolladores
                </p>
                
                <div class="features-grid">
                    <div class="feature-card">
                        <i class="fas fa-user-plus"></i>
                        <h3>Gestión de Leads</h3>
                        <p>Pipeline completo, conversiones, seguimiento y métricas</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-building"></i>
                        <h3>Entidades y Contactos</h3>
                        <p>Organizaciones, contactos individuales y relaciones</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-envelope"></i>
                        <h3>Campañas Multi-Canal</h3>
                        <p>Email, WhatsApp, SMS con plantillas y métricas</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-calendar-alt"></i>
                        <h3>Gestión de Eventos</h3>
                        <p>Eventos, invitados, permisos y seguimiento</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-shield-alt"></i>
                        <h3>Sistema de Permisos</h3>
                        <p>Compartir, roles y control de acceso granular</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-chart-line"></i>
                        <h3>Analytics y Reportes</h3>
                        <p>Métricas, conversiones y análisis de rendimiento</p>
                    </div>
                </div>

                <div class="quick-start">
                    <h2>🚀 Inicio Rápido</h2>
                    <div class="quick-start-grid">
                        <div class="quick-item">
                            <h4>1. Configuración</h4>
                            <p>GraphQL API en puertos 3000 (test) y 4000 (producción)</p>
                        </div>
                        <div class="quick-item">
                            <h4>2. Autenticación</h4>
                            <p>JWT + Firebase para gestión de usuarios y permisos</p>
                        </div>
                        <div class="quick-item">
                            <h4>3. Base de Datos</h4>
                            <p>MongoDB Atlas con modelos optimizados para CRM</p>
                        </div>
                        <div class="quick-item">
                            <h4>4. Frontend</h4>
                            <p>React + TypeScript + Apollo Client</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- API GraphQL Section -->
        <section id="api" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-code"></i>
                    API GraphQL Completa
                </h2>

                <div class="api-overview">
                    <h3>📊 Resumen de Endpoints</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h4>Queries</h4>
                            <span class="stat-number">91</span>
                            <p>Consultas de lectura</p>
                        </div>
                        <div class="stat-card">
                            <h4>Mutations</h4>
                            <span class="stat-number">155</span>
                            <p>Operaciones de escritura</p>
                        </div>
                        <div class="stat-card">
                            <h4>Tipos</h4>
                            <span class="stat-number">100+</span>
                            <p>Modelos de datos</p>
                        </div>
                        <div class="stat-card">
                            <h4>Subscriptions</h4>
                            <span class="stat-number">1</span>
                            <p>Tiempo real</p>
                        </div>
                    </div>
                </div>

                <div class="index-links">
                    <h3>🔗 Enlaces Directos a Secciones</h3>
                    <ul>
                        <li><a href="#api">📊 Tipos Principales del CRM</a></li>
                        <li><a href="#api">🔧 Enums y Tipos Especializados</a></li>
                        <li><a href="#api">📥 Queries Principales</a></li>
                        <li><a href="#api">📤 Mutations Principales</a></li>
                        <li><a href="#api">⚡ Subscriptions en Tiempo Real</a></li>
                        <li><a href="#api">🔗 Webhooks y Integraciones</a></li>
                        <li><a href="#events">📅 Gestión de Eventos</a></li>
                        <li><a href="#events">🔍 Queries de Eventos</a></li>
                        <li><a href="#events">📤 Mutations de Eventos</a></li>
                        <li><a href="#events">🔐 Sistema de Permisos</a></li>
                        <li><a href="#campaigns">📢 Gestión de Campañas</a></li>
                        <li><a href="#campaigns">🔍 Queries de Campañas</a></li>
                        <li><a href="#whitelabel">🏢 Sistema Whitelabel</a></li>
                        <li><a href="#permissions">🔐 Sistema de Permisos</a></li>
                        <li><a href="#complete-systems">🎯 Sistemas de Compartición</a></li>
                    </ul>
                </div>

                <div class="index-links">
                    <h3>🔗 Enlaces Directos a Secciones</h3>
                    <ul>
                        <li><a href="#api">📊 Tipos Principales del CRM</a></li>
                        <li><a href="#api">🔧 Enums y Tipos Especializados</a></li>
                        <li><a href="#api">📥 Queries Principales</a></li>
                        <li><a href="#api">📤 Mutations Principales</a></li>
                        <li><a href="#api">⚡ Subscriptions en Tiempo Real</a></li>
                        <li><a href="#api">🔗 Webhooks y Integraciones</a></li>
                        <li><a href="#events">📅 Gestión de Eventos</a></li>
                        <li><a href="#events">🔍 Queries de Eventos</a></li>
                        <li><a href="#events">📤 Mutations de Eventos</a></li>
                        <li><a href="#events">🔐 Sistema de Permisos</a></li>
                        <li><a href="#campaigns">📢 Gestión de Campañas</a></li>
                        <li><a href="#campaigns">🔍 Queries de Campañas</a></li>
                        <li><a href="#whitelabel">🏢 Sistema Whitelabel</a></li>
                        <li><a href="#permissions">🔐 Sistema de Permisos</a></li>
                        <li><a href="#complete-systems">🎯 Sistemas de Compartición</a></li>
                    </ul>
                </div>

                <div class="api-modules">
                    <h3>🏗️ Módulos Principales</h3>
                    
                    <div class="module-card">
                        <h4><i class="fas fa-user-plus"></i> CRM - Gestión de Relaciones</h4>
                        <div class="module-content">
                            <h5>Tipos Principales:</h5>
                            <ul>
                                <li><strong>CRM_Lead</strong> - 26 campos (pipeline, conversiones, métricas)</li>
                                <li><strong>CRM_Contact</strong> - 32 campos (contactos individuales)</li>
                                <li><strong>CRM_Entity</strong> - 26 campos (organizaciones/empresas)</li>
                                <li><strong>CRM_Campaign</strong> - 18 campos (campañas multi-canal)</li>
                                <li><strong>CRM_Note</strong> - 8 campos (notas y seguimiento)</li>
                                <li><strong>CRM_Reminder</strong> - 6 campos (recordatorios)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="module-card">
                        <h4><i class="fas fa-calendar-alt"></i> EVT - Gestión de Eventos</h4>
                        <div class="module-content">
                            <h5>Tipos Principales:</h5>
                            <ul>
                                <li><strong>EVT_Event</strong> - 27 campos (eventos principales)</li>
                                <li><strong>EVT_Invitado</strong> - 10 campos (gestión de invitados)</li>
                                <li><strong>EVT_Presupuesto</strong> - 7 campos (control financiero)</li>
                                <li><strong>EVT_Task</strong> - 7 campos (tareas del evento)</li>
                                <li><strong>EVT_Itinerario</strong> - 5 campos (agenda)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="module-card">
                        <h4><i class="fas fa-building"></i> 🏢 Whitelabel/Developer - Sistema Multi-Tenant</h4>
                        <div class="module-content">
                            <h5>Tipos Principales:</h5>
                            <ul>
                                <li><strong>WhitelabelDeveloper</strong> - Gestión de desarrolladores</li>
                                <li><strong>WhitelabelInfo</strong> - Información de marca blanca</li>
                                <li><strong>Development</strong> - Entornos de desarrollo</li>
                                <li><strong>User</strong> - Usuarios con permisos multi-tenant</li>
                            </ul>
                            
                            <h5>🔑 Queries Principales:</h5>
                            <ul>
                                <li><strong>getWhitelabelDeveloper</strong> - Obtener desarrollador</li>
                                <li><strong>getWhitelabelInfo</strong> - Obtener info de marca blanca</li>
                                <li><strong>getDevelopment</strong> - Obtener entorno de desarrollo</li>
                                <li><strong>getUserByDevelopment</strong> - Usuarios por development</li>
                            </ul>
                            
                            <h5>⚙️ Mutations Principales:</h5>
                            <ul>
                                <li><strong>createWhitelabelDeveloper</strong> - Crear desarrollador</li>
                                <li><strong>updateWhitelabelInfo</strong> - Actualizar marca blanca</li>
                                <li><strong>assignUserToDevelopment</strong> - Asignar usuario</li>
                                <li><strong>updateDevelopmentPermissions</strong> - Actualizar permisos</li>
                            </ul>
                        </div>
                    </div>

                    <div class="module-card">
                        <h4><i class="fas fa-building"></i> BUSN - Gestión de Negocios</h4>
                        <div class="module-content">
                            <h5>Tipos Principales:</h5>
                            <ul>
                                <li><strong>BUSN_Business</strong> - 21 campos (negocios/empresas)</li>
                                <li><strong>BUSN_reviewsT</strong> - 6 campos (reseñas)</li>
                                <li><strong>BUSN_questionsAndAnswers</strong> - 2 campos (FAQ)</li>
                                <li><strong>BUSN_horario</strong> - 2 campos (horarios)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="module-card">
                        <h4><i class="fas fa-chart-line"></i> USAGE - Analytics y Métricas</h4>
                        <div class="module-content">
                            <h5>Tipos Principales:</h5>
                            <ul>
                                <li><strong>USAGE_UsageTracking</strong> - 20 campos (seguimiento)</li>
                                <li><strong>USAGE_CampaignBilling</strong> - 11 campos (facturación)</li>
                                <li><strong>USAGE_DeliveryMetrics</strong> - 6 campos (métricas)</li>
                                <li><strong>USAGE_DashboardStats</strong> - 5 campos (dashboard)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="authentication">
                    <h3>🔐 Autenticación y Seguridad</h3>
                    <div class="auth-content">
                        <h4>JWT + Firebase Authentication</h4>
                        <p>El sistema utiliza autenticación JWT con Firebase para gestionar usuarios, roles y permisos de forma segura.</p>
                        
                        <h4>Headers Requeridos:</h4>
                        <pre><code class="language-http">Authorization: Bearer &lt;JWT_TOKEN&gt;
Content-Type: application/json</code></pre>
                        
                        <h4>Tipos de Usuario:</h4>
                        <ul>
                            <li><strong>Admin</strong> - Acceso completo al sistema</li>
                            <li><strong>Manager</strong> - Gestión de equipos y proyectos</li>
                            <li><strong>User</strong> - Acceso limitado a recursos asignados</li>
                            <li><strong>Guest</strong> - Acceso de solo lectura</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Campaigns Section -->
        <section id="campaigns" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-envelope"></i>
                    Sistema de Campañas Multi-Canal
                </h2>

                <div class="campaign-overview">
                    <h3>📧 Funcionalidades de Campañas</h3>
                    <p>El sistema CRM incluye un motor completo de campañas que se integra directamente con leads, contactos y entidades.</p>
                </div>

                <div class="campaign-types">
                    <h3>🎯 Tipos de Campaña</h3>
                    
                    <div class="campaign-card">
                        <h4><i class="fas fa-envelope"></i> Campañas de Email</h4>
                        <div class="campaign-content">
                            <h5>Características:</h5>
                            <ul>
                                <li><strong>Plantillas Personalizables</strong> - 14 campos configurables</li>
                                <li><strong>Segmentación Avanzada</strong> - Filtros dinámicos por criterios</li>
                                <li><strong>Automatización</strong> - Envíos programados y triggers</li>
                                <li><strong>Métricas Completas</strong> - Apertura, clics, conversiones</li>
                            </ul>
                        </div>
                    </div>

                    <div class="campaign-card">
                        <h4><i class="fas fa-whatsapp"></i> Campañas de WhatsApp</h4>
                        <div class="campaign-content">
                            <h5>Características:</h5>
                            <ul>
                                <li><strong>Plantillas WhatsApp Business</strong> - 13 campos configurables</li>
                                <li><strong>Integración API</strong> - Conexión directa con WhatsApp</li>
                                <li><strong>Respuestas Automáticas</strong> - Chatbots y flujos</li>
                                <li><strong>Métricas de Entrega</strong> - Estado, lectura, respuesta</li>
                            </ul>
                        </div>
                    </div>

                    <div class="campaign-card">
                        <h4><i class="fas fa-sms"></i> Campañas SMS</h4>
                        <div class="campaign-content">
                            <h5>Características:</h5>
                            <ul>
                                <li><strong>Plantillas de Texto</strong> - Personalización con variables</li>
                                <li><strong>Envio Masivo</strong> - Gestión de listas de contactos</li>
                                <li><strong>Confirmación de Entrega</strong> - Tracking de estado</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="campaign-integration">
                    <h3>🔗 Integración con CRM</h3>
                    
                    <div class="integration-flow">
                        <h4>Flujo de Campaña:</h4>
                        <ol>
                            <li><strong>Selección de Audiencia</strong> - Leads, contactos o entidades</li>
                            <li><strong>Creación de Plantilla</strong> - Email, WhatsApp o SMS</li>
                            <li><strong>Configuración de Envío</strong> - Programación y automatización</li>
                            <li><strong>Ejecución</strong> - Envío automático o manual</li>
                            <li><strong>Seguimiento</strong> - Métricas y engagement</li>
                            <li><strong>Conversión</strong> - Actualización de estado de leads</li>
                        </ol>
                    </div>

                    <div class="campaign-examples">
                        <h4>Casos de Uso:</h4>
                        <ul>
                            <li><strong>Onboarding</strong> - Bienvenida a nuevos leads</li>
                            <li><strong>Nurturing</strong> - Cultivo de leads en pipeline</li>
                            <li><strong>Eventos</strong> - Invitaciones y recordatorios</li>
                            <li><strong>Follow-up</strong> - Seguimiento post-venta</li>
                            <li><strong>Reactivación</strong> - Re-engagement de contactos</li>
                        </ul>
                    </div>
                </div>

                <div class="campaign-queries">
                    <h3>🔍 Queries de Campañas</h3>
                    
                    <div class="query-examples">
                        <h4>Consultas Principales:</h4>
                        <pre><code class="language-graphql"># Obtener todas las campañas
query GetCampaigns {
  getCRMCampaigns {
    campaigns {
      _id
      name
      type
      status
      createdAt
      scheduledAt
      targetAudience
      metrics {
        sent
        delivered
        opened
        clicked
        converted
      }
    }
  }
}

# Obtener estadísticas de campaña
query GetCampaignStats($campaignId: ID!) {
  getCRMCampaignStats(campaignId: $campaignId) {
    totalSent
    totalDelivered
    totalOpened
    totalClicked
    totalConverted
    conversionRate
    openRate
    clickRate
    deliveryRate
  }
}

# Obtener plantillas de email
query GetEmailTemplates {
  getCRMEmailTemplates {
    templates {
      _id
      name
      subject
      content
      variables
      isActive
      createdAt
    }
  }
}</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Events Section -->
        <section id="events" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-calendar-alt"></i>
                    Gestión de Eventos y Invitados
                </h2>

                <div class="events-overview">
                    <h3>🎉 Sistema de Eventos</h3>
                    <p>El sistema incluye gestión completa de eventos con invitados, permisos, presupuestos y seguimiento.</p>
                </div>

                <div class="event-queries">
                    <h3>🔍 Consultas de Eventos</h3>
                    
                    <div class="query-examples">
                        <h4>Búsqueda por Teléfono/Email:</h4>
                        <pre><code class="language-graphql"># Buscar eventos por teléfono del usuario
query GetEventsByPhone($phone: String!) {
  getAllUserRelatedEventsByPhone(phone: $phone) {
    _id
    name
    date
    location
    status
    role
    permissions
  }
}

# Buscar eventos por email del usuario
query GetEventsByEmail($email: String!) {
  getAllUserRelatedEventsByEmail(email: $email) {
    _id
    name
    date
    location
    status
    role
    permissions
  }
}

# Obtener evento específico con detalles
query GetEvent($eventId: ID!) {
  getEvent(eventId: $eventId) {
    _id
    name
    description
    date
    location
    status
    budget {
      total
      spent
      remaining
    }
    guests {
      _id
      name
      email
      phone
      status
      role
    }
    tasks {
      _id
      title
      description
      assignedTo
      dueDate
      status
    }
  }
}</code></pre>
                    </div>
                </div>

                <div class="event-permissions">
                    <h3>🔐 Permisos de Eventos</h3>
                    
                    <div class="permission-types">
                        <h4>Tipos de Permisos:</h4>
                        <ul>
                            <li><strong>Owner</strong> - Propietario del evento (acceso completo)</li>
                            <li><strong>Admin</strong> - Administrador (gestión completa)</li>
                            <li><strong>Manager</strong> - Gestor (edición y gestión)</li>
                            <li><strong>Editor</strong> - Editor (modificación limitada)</li>
                            <li><strong>Viewer</strong> - Visualizador (solo lectura)</li>
                            <li><strong>Guest</strong> - Invitado (acceso básico)</li>
                        </ul>
                    </div>

                    <div class="permission-queries">
                        <h4>Consultas de Permisos:</h4>
                        <pre><code class="language-graphql"># Verificar permisos de usuario en evento
query CheckEventPermissions($eventId: ID!, $userId: ID!) {
  getEventPermissions(eventId: $eventId, userId: $userId) {
    canView
    canEdit
    canDelete
    canManageGuests
    canManageBudget
    canManageTasks
    role
    permissions
  }
}

# Obtener resumen de permisos del usuario
query GetUserEventSummary($userId: ID!) {
  getUserCompleteEventSummary(userId: $userId) {
    ownedEvents
    managedEvents
    invitedEvents
    totalEvents
    upcomingEvents
    pastEvents
  }
}</code></pre>
                    </div>
                </div>

                <div class="event-management">
                    <h3>⚙️ Gestión de Eventos</h3>
                    
                    <div class="management-features">
                        <h4>Funcionalidades:</h4>
                        <ul>
                            <li><strong>Presupuesto</strong> - Control de gastos y categorías</li>
                            <li><strong>Tareas</strong> - Asignación y seguimiento</li>
                            <li><strong>Itinerario</strong> - Agenda y programación</li>
                            <li><strong>Invitados</strong> - Lista de asistencia y roles</li>
                            <li><strong>Métricas</strong> - Estadísticas de participación</li>
                        </ul>
                    </div>

                    <div class="event-mutations">
                        <h4>Operaciones de Eventos:</h4>
                        <pre><code class="language-graphql"># Compartir evento con usuario
mutation ShareEvent($eventId: ID!, $userId: ID!, $permissions: [String!]!) {
  shareEvent(eventId: $eventId, userId: $userId, permissions: $permissions) {
    success
    message
    sharedWith {
      _id
      name
      email
      permissions
    }
  }
}

# Crear tarea en evento
mutation CreateEventTask($eventId: ID!, $task: TaskInput!) {
  createEventTask(eventId: $eventId, task: $task) {
    _id
    title
    description
    assignedTo
    dueDate
    status
  }
}</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Permissions Section -->
        <section id="permissions" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-shield-alt"></i>
                    Sistema de Permisos y Compartir
                </h2>

                <div class="permissions-overview">
                    <h3>🔐 Control de Acceso Granular</h3>
                    <p>El sistema implementa un modelo de permisos avanzado que permite compartir recursos de forma segura y controlada.</p>
                </div>

                <div class="sharing-system">
                    <h3>🤝 Sistema de Compartir</h3>
                    
                    <div class="sharing-types">
                        <h4>Recursos Compartibles:</h4>
                        <ul>
                            <li><strong>Leads</strong> - Compartir oportunidades con equipo</li>
                            <li><strong>Contactos</strong> - Acceso a información de clientes</li>
                            <li><strong>Entidades</strong> - Compartir empresas/organizaciones</li>
                            <li><strong>Eventos</strong> - Colaboración en gestión</li>
                            <li><strong>Configuraciones</strong> - Compartir vistas y filtros</li>
                        </ul>
                    </div>

                    <div class="sharing-mutations">
                        <h4>Operaciones de Compartir:</h4>
                        <pre><code class="language-graphql"># Compartir lead con usuario
mutation ShareLead($leadId: ID!, $userId: ID!, $permissions: [String!]!) {
  shareCRMLead(leadId: $leadId, userId: $userId, permissions: $permissions) {
    success
    message
    sharedWith {
      _id
      name
      email
      permissions
    }
  }
}

# Compartir contacto con usuario
mutation ShareContact($contactId: ID!, $userId: ID!, $permissions: [String!]!) {
  shareCRMContact(contactId: $contactId, userId: $userId, permissions: $permissions) {
    success
    message
    sharedWith {
      _id
      name
      email
      permissions
    }
  }
}

# Compartir entidad con usuario
mutation ShareEntity($entityId: ID!, $userId: ID!, $permissions: [String!]!) {
  shareCRMEntity(entityId: $entityId, userId: $userId, permissions: $permissions) {
    success
    message
    sharedWith {
      _id
      name
      email
      permissions
    }
  }
}</code></pre>
                    </div>
                </div>

                <div class="permission-levels">
                    <h3>📊 Niveles de Permiso</h3>
                    
                    <div class="permission-matrix">
                        <h4>Matriz de Permisos:</h4>
                        <table class="permission-table">
                            <thead>
                                <tr>
                                    <th>Permiso</th>
                                    <th>Leer</th>
                                    <th>Editar</th>
                                    <th>Eliminar</th>
                                    <th>Compartir</th>
                                    <th>Administrar</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Owner</strong></td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>✅</td>
                                </tr>
                                <tr>
                                    <td><strong>Admin</strong></td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>✅</td>
                                </tr>
                                <tr>
                                    <td><strong>Manager</strong></td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>❌</td>
                                    <td>✅</td>
                                    <td>❌</td>
                                </tr>
                                <tr>
                                    <td><strong>Editor</strong></td>
                                    <td>✅</td>
                                    <td>✅</td>
                                    <td>❌</td>
                                    <td>❌</td>
                                    <td>❌</td>
                                </tr>
                                <tr>
                                    <td><strong>Viewer</strong></td>
                                    <td>✅</td>
                                    <td>❌</td>
                                    <td>❌</td>
                                    <td>❌</td>
                                    <td>❌</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="access-control">
                    <h3>🚪 Control de Acceso</h3>
                    
                    <div class="access-features">
                        <h4>Características:</h4>
                        <ul>
                            <li><strong>Heredado</strong> - Los permisos se heredan de entidades padre</li>
                            <li><strong>Temporal</strong> - Permisos con fecha de expiración</li>
                            <li><strong>Condicional</strong> - Permisos basados en reglas de negocio</li>
                            <li><strong>Auditoría</strong> - Log completo de accesos y cambios</li>
                            <li><strong>Notificaciones</strong> - Alertas de acceso y cambios</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Complete Systems Section -->
        <section id="complete-systems" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-share-alt"></i>
                    🎯 Sistemas Completos de Compartición y Control de Acceso
                </h2>

                <div class="systems-overview">
                    <h3>📋 RESUMEN EJECUTIVO DE TODOS LOS SISTEMAS</h3>
                    <p>El sistema implementa <strong>7 sistemas diferentes de compartición</strong>, cada uno con su propia lógica y estructura:</p>
                    
                    <div class="systems-grid">
                        <div class="system-card">
                            <h4>🏢 CRM System</h4>
                            <ul>
                                <li>Leads, Contactos, Entidades</li>
                                <li>Ownership + Shared Users + Groups</li>
                                <li>Multi-tenant por development</li>
                            </ul>
                        </div>
                        
                        <div class="system-card">
                            <h4>🎉 Event System</h4>
                            <ul>
                                <li>Eventos + Invitados</li>
                                <li>Roles: CREADOR, COMPARTIDO, INVITADO</li>
                                <li>Permisos granulares por funcionalidad</li>
                            </ul>
                        </div>
                        
                        <div class="system-card">
                            <h4>📝 Blog/Post System</h4>
                            <ul>
                                <li>Publicaciones y artículos</li>
                                <li>Compartición por usuario y business</li>
                                <li>Control de acceso por development</li>
                            </ul>
                        </div>
                        
                        <div class="system-card">
                            <h4>⚙️ ViewConfig System</h4>
                            <ul>
                                <li>Configuraciones de vista</li>
                                <li>Permisos: View, Edit, Delete, Share</li>
                                <li>Compartición con usuarios específicos</li>
                            </ul>
                        </div>
                        
                        <div class="system-card">
                            <h4>👥 Group System</h4>
                            <ul>
                                <li>Grupos de usuarios</li>
                                <li>Permisos a nivel de grupo</li>
                                <li>Filtros y configuraciones compartidas</li>
                            </ul>
                        </div>
                        
                        <div class="system-card">
                            <h4>🏪 Business System</h4>
                            <ul>
                                <li>Negocios y empresas</li>
                                <li>Usuarios asociados</li>
                                <li>Configuraciones por business</li>
                            </ul>
                        </div>
                        
                        <div class="system-card">
                            <h4>👤 User System</h4>
                            <ul>
                                <li>Usuarios y autenticación</li>
                                <li>Roles y permisos</li>
                                <li>Desarrollos autorizados</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="real-examples">
                    <h3>🔍 CASOS DE USO REALES Y EJEMPLOS PRÁCTICOS</h3>
                    
                    <div class="example-scenario">
                        <h4>📊 CASO 1: Lead Compartido entre Equipo de Ventas</h4>
                        <p><strong>Escenario:</strong> Un lead de alta prioridad es compartido entre el vendedor principal, su manager y un especialista técnico.</p>
                        
                        <pre><code class="language-graphql"># 1. Crear el lead (propietario principal)
mutation CreateLead {
  createCRMLead(input: {
    name: "Empresa ABC - Proyecto CRM"
    email: "contacto@empresaabc.com"
    company: "Empresa ABC"
    value: 50000
    priority: HIGH
    source: WEBSITE
  }) {
    success
    lead {
      _id
      ownership {
        primary_owner {
          user_id    # "vendedor123"
          name       # "vendedor@empresa.com"
        }
        shared_with_users    # []
        shared_with_groups   # []
      }
    }
  }
}

# 2. Compartir con manager individual
mutation ShareWithManager {
  shareCRMLead(leadId: "lead123", sharing: {
    userIds: ["manager456"]
    groupIds: []
    permissions: ["VIEW", "EDIT", "ADD_NOTES"]
  }) {
    success
    lead {
      ownership {
        shared_with_users    # ["manager456"]
        shared_with_groups   # []
      }
    }
  }
}</code></pre>

                        <div class="example-result">
                            <h5>🎯 Resultado Final:</h5>
                            <ul>
                                <li><strong>Propietario:</strong> vendedor123 (acceso completo)</li>
                                <li><strong>Compartido individual:</strong> manager456 (ver, editar, notas)</li>
                                <li><strong>Permisos:</strong> Diferentes niveles según el tipo de acceso</li>
                            </ul>
                        </div>
                    </div>

                    <div class="example-scenario">
                        <h4>🎉 CASO 2: Evento de Boda Compartido con Familia y Proveedores</h4>
                        <p><strong>Escenario:</strong> Una boda donde la novia comparte el evento con familiares cercanos y proveedores específicos.</p>
                        
                        <pre><code class="language-graphql"># 1. Crear evento (propietaria principal)
mutation CreateWeddingEvent {
  createEvent(input: {
    nombre: "Boda María y Carlos"
    tipo: "boda"
    fecha: "2025-06-15"
    poblacion: "Madrid"
    usuario_id: "maria_novia"
    usuario_nombre: "maria@email.com"
  }) {
    _id
    usuario_id        # "maria_novia"
    compartido_array  # []
    user_role         # "CREADOR"
    user_permissions  # ["FULL_ACCESS"]
  }
}

# 2. Compartir con familiares (acceso completo)
mutation ShareWithFamily {
  shareEvent(
    eventId: "event456", 
    userId: "madre_maria", 
    permissions: {
      canViewBudget: true,
      canViewGuests: true,
      canEditEvent: true,
      canInviteGuests: true
    }
  )
}</code></pre>

                        <div class="example-result">
                            <h5>🎯 Resultado Final:</h5>
                            <ul>
                                <li><strong>Propietaria:</strong> maria_novia (acceso completo)</li>
                                <li><strong>Familiar:</strong> madre_maria (acceso completo)</li>
                                <li><strong>Permisos:</strong> Diferentes según el rol y relación</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="validation-flow">
                    <h3>🔐 FLUJO COMPLETO DE VALIDACIÓN Y PERMISOS</h3>
                    
                    <h4>🔄 Proceso de Validación Multi-Nivel</h4>
                    <pre><code class="language-text">┌─────────────────────────────────────────────────────────────────┐
│                FLUJO COMPLETO DE VALIDACIÓN                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐ │
│  │   REQUEST      │    │   VALIDACIÓN    │    │   ACCESO    │ │
│  │   INCOMING     │───▶│   MULTI-NIVEL   │───▶│   GRANTED   │ │
│  └─────────────────┘    └─────────────────┘    └─────────────┘ │
│           │                       │                    │        │
│           │                       │                    │        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐ │
│  │   HEADERS       │    │   PASO 1:      │    │   PASO 2:   │ │
│  │   VERIFICATION  │    │   JWT TOKEN     │    │   USER      │ │
│  │                 │    │   VALIDATION    │    │   CONTEXT   │ │
│  │ • Authorization │    │                 │    │             │ │
│  │ • X-User-ID     │    │ • Token válido  │    │ • UID       │ │
│  │ • X-Development │    │ • No expirado   │    │ • Email     │ │
│  └─────────────────┘    │ • Signature OK  │    │ • Phone     │ │
│                          └─────────────────┘    │ • Role      │ │
│                                   │             └─────────────┘ │
│                                   │                     │        │
│                          ┌─────────────────┐    ┌─────────────┐ │
│                          │   PASO 3:      │    │   PASO 4:   │ │
│                          │   DEVELOPMENT   │    │   OWNERSHIP │ │
│                          │   ACCESS        │    │   CHECK     │ │
│                          │                 │    │             │ │
│                          │ • Same tenant   │    │ • Is Owner? │ │
│                          │ • Valid brand   │    │ • Is Shared?│ │
│                          │ • Features OK   │    │ • Is Group? │ │
│                          └─────────────────┘    │ • Permissions│ │
│                                   │             └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘</code></pre>

                    <h4>🔍 Código de Validación Implementado</h4>
                    <pre><code class="language-typescript">// 1. VALIDACIÓN DE DESARROLLO (Multi-tenant)
export function validateDevelopmentAccess(
  context: CRMContext,
  development: string
) {
  if (context.user.development !== development) {
    throw new Error('No tienes acceso a este development');
  }
}

// 2. VALIDACIÓN DE OWNERSHIP
export function validateOwnership(
  document: any,
  userId: string,
  allowShared: boolean = true
) {
  const isOwner = document.ownership?.primary_owner?.user_id === userId;
  const isShared = allowShared && 
    document.ownership?.shared_with_users?.includes(userId);
  
  if (!isOwner && !isShared) {
    throw new Error('No tienes permisos para acceder a este recurso');
  }

  return { isOwner, isShared };
}</code></pre>
                </div>

                <div class="systems-comparison">
                    <h3>📊 COMPARATIVA DE SISTEMAS DE COMPARTICIÓN</h3>
                    
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Sistema</th>
                                <th>Estructura de Ownership</th>
                                <th>Tipos de Compartición</th>
                                <th>Permisos Granulares</th>
                                <th>Multi-Tenant</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>🏢 CRM System</strong></td>
                                <td>primary_owner + shared_with_users + shared_with_groups</td>
                                <td>Individual + Grupos</td>
                                <td>Por rol (Owner, Shared, None)</td>
                                <td>✅ Por development</td>
                            </tr>
                            <tr>
                                <td><strong>🎉 Event System</strong></td>
                                <td>usuario_id + compartido_array + detalles_compartidos_array</td>
                                <td>Individual + Permisos específicos</td>
                                <td>Por funcionalidad (Budget, Guests, etc.)</td>
                                <td>✅ Por development</td>
                            </tr>
                            <tr>
                                <td><strong>📝 Blog/Post System</strong></td>
                                <td>userUid + businessId + development</td>
                                <td>Por business + development</td>
                                <td>Por tenant (business + development)</td>
                                <td>✅ Por business + development</td>
                            </tr>
                            <tr>
                                <td><strong>⚙️ ViewConfig System</strong></td>
                                <td>createdBy + sharedWith + permissions</td>
                                <td>Individual + Permisos específicos</td>
                                <td>View, Edit, Delete, Share</td>
                                <td>✅ Por business</td>
                            </tr>
                            <tr>
                                <td><strong>👥 Group System</strong></td>
                                <td>createdBy + members + permissions</td>
                                <td>Por membresía</td>
                                <td>View, Edit, Delete</td>
                                <td>✅ Por business</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="best-practices">
                    <h3>🚀 MEJORES PRÁCTICAS Y RECOMENDACIONES</h3>
                    
                    <h4>✅ PRÁCTICAS RECOMENDADAS</h4>
                    <ul>
                        <li><strong>Seguridad por defecto:</strong> Siempre validar development access antes de ownership</li>
                        <li><strong>Permisos granulares:</strong> Usar permisos específicos en lugar de roles genéricos</li>
                        <li><strong>Auditoría:</strong> Registrar todas las acciones de compartición</li>
                        <li><strong>Validación en cascada:</strong> JWT → Development → Ownership → Permisos</li>
                        <li><strong>Límites de compartición:</strong> Máximo 50 usuarios individuales, 20 grupos</li>
                    </ul>

                    <h4>⚠️ PRÁCTICAS A EVITAR</h4>
                    <ul>
                        <li><strong>Permisos globales:</strong> No dar acceso completo por defecto</li>
                        <li><strong>Compartición masiva:</strong> Evitar compartir con grupos muy grandes</li>
                        <li><strong>Permisos heredados:</strong> No asumir permisos por pertenencia a grupo</li>
                        <li><strong>Validación única:</strong> No confiar solo en JWT, validar ownership</li>
                        <li><strong>Permisos permanentes:</strong> Revisar regularmente accesos compartidos</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Frontend Section -->
        <section id="frontend" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-code"></i>
                    Configuración Frontend
                </h2>

                <div class="frontend-setup">
                    <h3>⚙️ Configuración del Proyecto</h3>
                    
                    <div class="setup-steps">
                        <h4>1. Instalación de Dependencias</h4>
                        <pre><code class="language-bash">npm install @apollo/client graphql react react-dom typescript
npm install @types/react @types/react-dom @types/node
npm install axios formik yup react-router-dom</code></pre>

                        <h4>2. Configuración de Apollo Client</h4>
                        <pre><code class="language-typescript">import { ApolloClient, InMemoryCache, createHttpLink } from '@apollo/client';
import { setContext } from '@apollo/client/link/context';

const httpLink = createHttpLink({
  uri: 'http://localhost:3000/graphql', // Test
  // uri: 'http://localhost:4000/graphql', // Production
});

const authLink = setContext((_, { headers }) => {
  const token = localStorage.getItem('authToken');
  return {
    headers: {
      ...headers,
      authorization: token ? `Bearer ${token}` : "",
    }
  }
});

const client = new ApolloClient({
  link: authLink.concat(httpLink),
  cache: new InMemoryCache()
});</code></pre>

                        <h4>3. Configuración de Rutas</h4>
                        <pre><code class="language-typescript">import { BrowserRouter, Routes, Route } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<Dashboard />} />
        <Route path="/leads" element={<Leads />} />
        <Route path="/contacts" element={<Contacts />} />
        <Route path="/entities" element={<Entities />} />
        <Route path="/campaigns" element={<Campaigns />} />
        <Route path="/events" element={<Events />} />
        <Route path="/analytics" element={<Analytics />} />
      </Routes>
    </BrowserRouter>
  );
}</code></pre>
                    </div>
                </div>

                <div class="component-examples">
                    <h3>🧩 Componentes de Ejemplo</h3>
                    
                    <div class="component-card">
                        <h4>Componente de Leads</h4>
                        <pre><code class="language-typescript">import React, { useState, useEffect } from 'react';
import { useQuery, useMutation } from '@apollo/client';
import { GET_CRM_LEADS, UPDATE_CRM_LEAD } from '../graphql/queries';

interface Lead {
  _id: string;
  name: string;
  email: string;
  phone: string;
  company: string;
  status: string;
  value: number;
  probability: number;
  assignedTo: string;
  createdAt: string;
}

const Leads: React.FC = () => {
  const [leads, setLeads] = useState<Lead[]>([]);
  const [loading, setLoading] = useState(true);
  
  const { data, loading: queryLoading } = useQuery(GET_CRM_LEADS, {
    variables: { limit: 50, offset: 0 }
  });

  const [updateLead] = useMutation(UPDATE_CRM_LEAD);

  useEffect(() => {
    if (data?.getCRMLeads?.leads) {
      setLeads(data.getCRMLeads.leads);
      setLoading(false);
    }
  }, [data]);

  const handleStatusChange = async (leadId: string, newStatus: string) => {
    try {
      await updateLead({
        variables: { leadId, updates: { status: newStatus } }
      });
      // Actualizar estado local
    } catch (error) {
      console.error('Error updating lead:', error);
    }
  };

  if (loading) return <div>Cargando leads...</div>;

  return (
    <div className="leads-container">
      <h2>Gestión de Leads</h2>
      <div className="leads-grid">
        {leads.map(lead => (
          <div key={lead._id} className="lead-card">
            <h3>{lead.name}</h3>
            <p>{lead.email}</p>
            <p>{lead.company}</p>
            <select 
              value={lead.status}
              onChange={(e) => handleStatusChange(lead._id, e.target.value)}
            >
              <option value="new">Nuevo</option>
              <option value="contacted">Contactado</option>
              <option value="qualified">Calificado</option>
              <option value="proposal">Propuesta</option>
              <option value="negotiation">Negociación</option>
              <option value="won">Ganado</option>
              <option value="lost">Perdido</option>
            </select>
          </div>
        ))}
      </div>
    </div>
  );
};

export default Leads;</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Whitelabel Section -->
        <section id="whitelabel" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-building"></i>
                    🏢 Sistema Whitelabel y Multi-Tenant Completo
                </h2>

                <div class="whitelabel-overview">
                    <h3>🌐 Arquitectura Multi-Tenant Avanzada</h3>
                    <p>El sistema implementa una arquitectura completa de marca blanca que permite a diferentes desarrolladores tener sus propios entornos personalizados con funcionalidades específicas, límites configurables y branding personalizado.</p>
                </div>

                <div class="whitelabel-components">
                    <h3>🏗️ Componentes del Sistema Whitelabel</h3>
                    
                    <div class="component-card">
                        <h4>👨‍💻 WhitelabelDeveloper</h4>
                        <div class="component-content">
                            <h5>Campos Principales:</h5>
                            <ul>
                                <li><strong>isEnabled</strong> - Estado habilitado/deshabilitado</li>
                                <li><strong>apiKey</strong> - Clave API única para el desarrollador</li>
                                <li><strong>webhookUrl</strong> - URL para notificaciones webhook</li>
                                <li><strong>allowedDomains</strong> - Dominios permitidos para el desarrollador</li>
                                <li><strong>rateLimit</strong> - Límite de llamadas API por minuto</li>
                                <li><strong>features</strong> - Array de funcionalidades habilitadas</li>
                            </ul>
                        </div>
                    </div>

                    <div class="component-card">
                        <h4>🏷️ Whitelabel (Marca Principal)</h4>
                        <div class="component-content">
                            <h5>Campos Principales:</h5>
                            <ul>
                                <li><strong>id</strong> - ID único de la marca blanca</li>
                                <li><strong>name</strong> - Nombre de la marca</li>
                                <li><strong>slug</strong> - Slug único para URLs</li>
                                <li><strong>domain</strong> - Dominio personalizado</li>
                                <li><strong>isActive</strong> - Estado activo/inactivo</li>
                                <li><strong>createdAt/updatedAt</strong> - Timestamps</li>
                            </ul>
                        </div>
                    </div>

                    <div class="component-card">
                        <h4>🔥 WhitelabelFirebase</h4>
                        <div class="component-content">
                            <h5>Configuración Firebase:</h5>
                            <ul>
                                <li><strong>projectId</strong> - ID del proyecto Firebase</li>
                                <li><strong>apiKey</strong> - Clave API de Firebase</li>
                                <li><strong>authDomain</strong> - Dominio de autenticación</li>
                                <li><strong>storageBucket</strong> - Bucket de almacenamiento</li>
                                <li><strong>messagingSenderId</strong> - ID del remitente de mensajes</li>
                                <li><strong>appId</strong> - ID de la aplicación</li>
                            </ul>
                        </div>
                    </div>

                    <div class="component-card">
                        <h4>🗄️ WhitelabelDatabase</h4>
                        <div class="component-content">
                            <h5>Configuración de Base de Datos:</h5>
                            <ul>
                                <li><strong>name</strong> - Nombre de la base de datos</li>
                                <li><strong>connectionString</strong> - String de conexión</li>
                                <li><strong>collections</strong> - Colecciones disponibles</li>
                                <li><strong>backupEnabled</strong> - Backups habilitados</li>
                                <li><strong>backupFrequency</strong> - Frecuencia de backups</li>
                            </ul>
                        </div>
                    </div>

                    <div class="component-card">
                        <h4>⚙️ WhitelabelFeatures</h4>
                        <div class="component-content">
                            <h5>Funcionalidades Disponibles:</h5>
                            <ul>
                                <li><strong>events</strong> - Gestión de eventos</li>
                                <li><strong>users</strong> - Gestión de usuarios</li>
                                <li><strong>analytics</strong> - Analytics y reportes</li>
                                <li><strong>notifications</strong> - Sistema de notificaciones</li>
                                <li><strong>payments</strong> - Procesamiento de pagos</li>
                                <li><strong>integrations</strong> - Integraciones externas</li>
                                <li><strong>customBranding</strong> - Branding personalizado</li>
                                <li><strong>multiLanguage</strong> - Soporte multi-idioma</li>
                            </ul>
                        </div>
                    </div>

                    <div class="component-card">
                        <h4>🎨 WhitelabelSettings</h4>
                        <div class="component-content">
                            <h5>Configuraciones Personalizables:</h5>
                            <ul>
                                <li><strong>theme</strong> - Tema visual (JSON)</li>
                                <li><strong>branding</strong> - Configuración de marca (JSON)</li>
                                <li><strong>notifications</strong> - Configuración de notificaciones (JSON)</li>
                                <li><strong>security</strong> - Configuración de seguridad (JSON)</li>
                                <li><strong>performance</strong> - Configuración de rendimiento (JSON)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="component-card">
                        <h4>📊 WhitelabelLimits</h4>
                        <div class="component-content">
                            <h5>Límites Configurables:</h5>
                            <ul>
                                <li><strong>users</strong> - Número máximo de usuarios</li>
                                <li><strong>events</strong> - Número máximo de eventos</li>
                                <li><strong>storage</strong> - Almacenamiento máximo (MB/GB)</li>
                                <li><strong>apiCalls</strong> - Llamadas API máximas por día</li>
                                <li><strong>customizations</strong> - Número de personalizaciones</li>
                            </ul>
                        </div>
                    </div>

                    <div class="component-card">
                        <h4>📈 WhitelabelStats</h4>
                        <div class="component-content">
                            <h5>Estadísticas en Tiempo Real:</h5>
                            <ul>
                                <li><strong>totalUsers</strong> - Total de usuarios registrados</li>
                                <li><strong>totalEvents</strong> - Total de eventos creados</li>
                                <li><strong>activeUsers</strong> - Usuarios activos en el último mes</li>
                                <li><strong>storageUsed</strong> - Almacenamiento utilizado</li>
                                <li><strong>apiCallsToday</strong> - Llamadas API del día</li>
                                <li><strong>lastActivity</strong> - Última actividad registrada</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="whitelabel-queries">
                    <h3>🔍 Queries de Whitelabel Disponibles</h3>
                    
                    <div class="query-examples">
                        <h4>Consultas Principales:</h4>
                        <pre><code class="language-graphql"># Obtener todas las marcas blancas con paginación
query GetWhitelabels($page: Int, $limit: Int, $search: String, $isActive: Boolean, $hasDeveloper: Boolean) {
  getWhitelabels(page: $page, limit: $limit, search: $search, isActive: $isActive, hasDeveloper: $hasDeveloper) {
    success
    whitelabels {
      id
      name
      slug
      domain
      isActive
      createdAt
      developer {
        isEnabled
        apiKey
        allowedDomains
        rateLimit
      }
      features {
        events
        users
        analytics
        notifications
        payments
        integrations
        customBranding
        multiLanguage
      }
      limits {
        users
        events
        storage
        apiCalls
        customizations
      }
      stats {
        totalUsers
        totalEvents
        activeUsers
        storageUsed
        apiCallsToday
        lastActivity
      }
    }
    total
    page
    limit
    errors
  }
}

# Obtener marca blanca específica por ID
query GetWhitelabel($id: ID!) {
  getWhitelabel(id: $id) {
    success
    message
    whitelabel {
      id
      name
      slug
      domain
      isActive
      createdAt
      updatedAt
      developer {
        isEnabled
        apiKey
        webhookUrl
        allowedDomains
        rateLimit
        features
      }
      firebase {
        projectId
        apiKey
        authDomain
        storageBucket
        messagingSenderId
        appId
      }
      database {
        name
        connectionString
        collections
        backupEnabled
        backupFrequency
      }
      features {
        events
        users
        analytics
        notifications
        payments
        integrations
        customBranding
        multiLanguage
      }
      settings {
        theme
        branding
        notifications
        security
        performance
      }
      limits {
        users
        events
        storage
        apiCalls
        customizations
      }
      stats {
        totalUsers
        totalEvents
        activeUsers
        storageUsed
        apiCallsToday
        lastActivity
      }
    }
    errors
  }
}

# Obtener marca blanca por slug
query GetWhitelabelBySlug($slug: String!) {
  getWhitelabelBySlug(slug: $slug) {
    success
    message
    whitelabel {
      id
      name
      slug
      domain
      isActive
      createdAt
      developer {
        isEnabled
        apiKey
        allowedDomains
      }
      features {
        events
        users
        analytics
      }
    }
    errors
  }
}

# Obtener marca blanca por dominio
query GetWhitelabelByDomain($domain: String!) {
  getWhitelabelByDomain(domain: $domain) {
    success
    message
    whitelabel {
      id
      name
      slug
      domain
      isActive
      developer {
        isEnabled
        apiKey
      }
    }
    errors
  }
}

# Obtener estadísticas de marca blanca
query GetWhitelabelStats($id: ID!) {
  getWhitelabelStats(id: $id) {
    success
    message
    whitelabel {
      id
      name
      stats {
        totalUsers
        totalEvents
        activeUsers
        storageUsed
        apiCallsToday
        lastActivity
      }
    }
    errors
  }
}

# Verificar disponibilidad de slug
query CheckSlugAvailability($slug: String!) {
  checkSlugAvailability(slug: $slug)
}

# Obtener marcas blancas activas
query GetActiveWhitelabels {
  getActiveWhitelabels {
    success
    whitelabels {
      id
      name
      slug
      domain
      isActive
      createdAt
      developer {
        isEnabled
        apiKey
      }
    }
    total
    errors
  }
}</code></pre>
                    </div>
                </div>

                <div class="whitelabel-mutations">
                    <h3>⚙️ Mutations de Whitelabel Disponibles</h3>
                    
                    <div class="mutation-examples">
                        <h4>Operaciones Principales:</h4>
                        <pre><code class="language-graphql"># Crear nueva marca blanca
mutation CreateWhitelabel($input: CreateWhitelabelInput!) {
  createWhitelabel(input: $input) {
    success
    message
    whitelabel {
      id
      name
      slug
      domain
      isActive
      createdAt
      developer {
        isEnabled
        apiKey
        allowedDomains
        rateLimit
      }
      features {
        events
        users
        analytics
        notifications
        payments
        integrations
        customBranding
        multiLanguage
      }
      limits {
        users
        events
        storage
        apiCalls
        customizations
      }
    }
    errors
  }
}

# Actualizar marca blanca existente
mutation UpdateWhitelabel($id: ID!, $input: UpdateWhitelabelInput!) {
  updateWhitelabel(id: $id, input: $input) {
    success
    message
    whitelabel {
      id
      name
      slug
      domain
      isActive
      updatedAt
      developer {
        isEnabled
        apiKey
        allowedDomains
        rateLimit
      }
      features {
        events
        users
        analytics
        notifications
        payments
        integrations
        customBranding
        multiLanguage
      }
      limits {
        users
        events
        storage
        apiCalls
        customizations
      }
    }
    errors
  }
}

# Eliminar marca blanca
mutation DeleteWhitelabel($id: ID!) {
  deleteWhitelabel(id: $id) {
    success
    message
    whitelabel {
      id
      name
      slug
    }
    errors
  }
}

# Cambiar estado activo/inactivo
mutation ToggleWhitelabelStatus($id: ID!) {
  toggleWhitelabelStatus(id: $id) {
    success
    message
    whitelabel {
      id
      name
      isActive
    }
    errors
  }
}

# Configurar developer embebido
mutation ConfigureDeveloper($id: ID!, $developer: WhitelabelDeveloperInput!) {
  configureDeveloper(id: $id, developer: $developer) {
    success
    message
    whitelabel {
      id
      name
      developer {
        isEnabled
        apiKey
        webhookUrl
        allowedDomains
        rateLimit
        features
      }
    }
    errors
  }
}

# Configurar Firebase
mutation ConfigureFirebase($id: ID!, $firebase: WhitelabelFirebaseInput!) {
  configureFirebase(id: $id, firebase: $firebase) {
    success
    message
    whitelabel {
      id
      name
      firebase {
        projectId
        apiKey
        authDomain
        storageBucket
        messagingSenderId
        appId
      }
    }
    errors
  }
}

# Configurar base de datos
mutation ConfigureDatabase($id: ID!, $database: WhitelabelDatabaseInput!) {
  configureDatabase(id: $id, database: $database) {
    success
    message
    whitelabel {
      id
      name
      database {
        name
        connectionString
        collections
        backupEnabled
        backupFrequency
      }
    }
    errors
  }
}

# Actualizar features
mutation UpdateFeatures($id: ID!, $features: WhitelabelFeaturesInput!) {
  updateFeatures(id: $id, features: $features) {
    success
    message
    whitelabel {
      id
      name
      features {
        events
        users
        analytics
        notifications
        payments
        integrations
        customBranding
        multiLanguage
      }
    }
    errors
  }
}

# Actualizar settings
mutation UpdateSettings($id: ID!, $settings: WhitelabelSettingsInput!) {
  updateSettings(id: $id, settings: $settings) {
    success
    message
    whitelabel {
      id
      name
      settings {
        theme
        branding
        notifications
        security
        performance
      }
    }
    errors
  }
}

# Actualizar límites
mutation UpdateLimits($id: ID!, $limits: WhitelabelLimitsInput!) {
  updateLimits(id: $id, limits: $limits) {
    success
    message
    whitelabel {
      id
      name
      limits {
        users
        events
        storage
        apiCalls
        customizations
      }
    }
    errors
  }
}

# Regenerar API key
mutation RegenerateApiKey($id: ID!) {
  regenerateApiKey(id: $id) {
    success
    message
    whitelabel {
      id
      name
      developer {
        apiKey
      }
    }
    errors
  }
}

# Clonar marca blanca
mutation CloneWhitelabel($id: ID!, $newName: String!, $newSlug: String!) {
  cloneWhitelabel(id: $id, newName: $newName, newSlug: $newSlug) {
    success
    message
    whitelabel {
      id
      name
      slug
      domain
      isActive
      createdAt
      developer {
        isEnabled
        apiKey
      }
    }
    errors
  }
}</code></pre>
                    </div>
                </div>

                <div class="whitelabel-use-cases">
                    <h3>🎯 Casos de Uso del Sistema Whitelabel</h3>
                    
                    <div class="use-case-card">
                        <h4>1. 🏢 Empresa que Vende Software como Servicio (SaaS)</h4>
                        <div class="use-case-content">
                            <h5>Escenario:</h5>
                            <p>Una empresa vende el CRM a diferentes clientes, cada uno con su propia marca, configuración y límites específicos.</p>
                            <h5>Implementación:</h5>
                            <ul>
                                <li>Crear Whitelabel para cada cliente con branding personalizado</li>
                                <li>Configurar WhitelabelDeveloper con API key única y límites</li>
                                <li>Habilitar/deshabilitar features según el plan del cliente</li>
                                <li>Configurar límites de usuarios, eventos y almacenamiento</li>
                                <li>Asignar dominio personalizado y configuración Firebase</li>
                            </ul>
                        </div>
                    </div>

                    <div class="use-case-card">
                        <h4>2. 🎨 Agencia de Marketing con Múltiples Clientes</h4>
                        <div class="use-case-content">
                            <h5>Escenario:</h5>
                            <p>Una agencia usa el sistema para gestionar campañas de diferentes clientes con marcas separadas.</p>
                            <h5>Implementación:</h5>
                            <ul>
                                <li>Development por cliente con su propia marca y colores</li>
                                <li>Usuarios de la agencia con acceso a múltiples developments</li>
                                <li>Permisos granulares por cliente y funcionalidad</li>
                                <li>Reportes separados por development con estadísticas</li>
                                <li>Configuración de webhooks para notificaciones por cliente</li>
                            </ul>
                        </div>
                    </div>

                    <div class="use-case-card">
                        <h4>3. 🏭 Empresa con Múltiples Divisiones</h4>
                        <div class="use-case-content">
                            <h5>Escenario:</h5>
                            <p>Una empresa grande con diferentes divisiones que necesitan sistemas independientes.</p>
                            <h5>Implementación:</h5>
                            <ul>
                                <li>Whitelabel por división con branding corporativo</li>
                                <li>Configuración de base de datos separada por división</li>
                                <li>Límites de recursos según presupuesto de cada división</li>
                                <li>Integración con sistemas internos de cada división</li>
                                <li>Reportes consolidados y por división</li>
                            </ul>
                        </div>
                    </div>

                    <div class="use-case-card">
                        <h4>4. 🌍 Empresa Internacional con Localización</h4>
                        <div class="use-case-content">
                            <h5>Escenario:</h5>
                            <p>Una empresa que opera en diferentes países con requisitos locales específicos.</p>
                            <h5>Implementación:</h5>
                            <ul>
                                <li>Whitelabel por país/región con idioma local</li>
                                <li>Configuración de pagos según moneda y métodos locales</li>
                                <li>Integración con servicios locales (bancos, proveedores)</li>
                                <li>Cumplimiento de regulaciones locales (GDPR, LGPD, etc.)</li>
                                <li>Configuración de timezone y formatos de fecha</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="whitelabel-tools">
                    <h3>🛠️ Herramientas MCP para Whitelabel</h3>
                    
                    <div class="tools-overview">
                        <h4>Herramientas Disponibles:</h4>
                        <ul>
                            <li><strong>get_whitelabels</strong> - Obtener lista de marcas blancas con filtros</li>
                            <li><strong>get_whitelabel</strong> - Obtener marca blanca específica por ID</li>
                            <li><strong>get_whitelabel_by_slug</strong> - Obtener marca blanca por slug</li>
                            <li><strong>get_whitelabel_by_domain</strong> - Obtener marca blanca por dominio</li>
                            <li><strong>create_whitelabel</strong> - Crear nueva marca blanca</li>
                            <li><strong>update_whitelabel</strong> - Actualizar marca blanca existente</li>
                            <li><strong>delete_whitelabel</strong> - Eliminar marca blanca</li>
                            <li><strong>configure_developer</strong> - Configurar developer embebido</li>
                            <li><strong>configure_firebase</strong> - Configurar Firebase</li>
                            <li><strong>configure_database</strong> - Configurar base de datos</li>
                            <li><strong>update_features</strong> - Actualizar funcionalidades</li>
                            <li><strong>update_limits</strong> - Actualizar límites</li>
                            <li><strong>regenerate_api_key</strong> - Regenerar clave API</li>
                            <li><strong>clone_whitelabel</strong> - Clonar marca blanca existente</li>
                        </ul>
                    </div>
                </div>

                <div class="whitelabel-examples">
                    <h3>💡 Ejemplos Prácticos de Implementación</h3>
                    
                    <div class="example-card">
                        <h4>📱 Crear Marca Blanca para App Móvil</h4>
                        <pre><code class="language-graphql">mutation CreateMobileAppWhitelabel {
  createWhitelabel(input: {
    name: "MiApp CRM"
    slug: "miapp-crm"
    domain: "miapp.example.com"
    isActive: true
    developer: {
      isEnabled: true
      allowedDomains: ["miapp.example.com", "app.miapp.com"]
      rateLimit: 1000
      features: ["events", "users", "analytics", "notifications"]
    }
    features: {
      events: true
      users: true
      analytics: true
      notifications: true
      payments: false
      integrations: true
      customBranding: true
      multiLanguage: false
    }
    limits: {
      users: 1000
      events: 500
      storage: 1024
      apiCalls: 10000
      customizations: 50
    }
  }) {
    success
    message
    whitelabel {
      id
      name
      slug
      developer {
        apiKey
        isEnabled
      }
    }
    errors
  }
}</code></pre>
                    </div>

                    <div class="example-card">
                        <h4>🏢 Configurar Empresa Corporativa</h4>
                        <pre><code class="language-graphql">mutation ConfigureCorporateWhitelabel {
  configureDeveloper(id: "whitelabel_id", developer: {
    isEnabled: true
    webhookUrl: "https://webhook.corporate.com/notifications"
    allowedDomains: ["corporate.com", "*.corporate.com"]
    rateLimit: 5000
    features: ["events", "users", "analytics", "notifications", "payments", "integrations"]
  }) {
    success
    message
    whitelabel {
      id
      name
      developer {
        apiKey
        webhookUrl
        allowedDomains
        rateLimit
      }
    }
    errors
  }
}</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Examples Section -->
        <section id="examples" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-lightbulb"></i>
                    Casos de Uso y Ejemplos
                </h2>

                <div class="use-cases">
                    <h3>🎯 Casos de Uso Principales</h3>
                    
                    <div class="use-case-card">
                        <h4>1. Gestión de Pipeline de Leads</h4>
                        <div class="use-case-content">
                            <h5>Flujo:</h5>
                            <ol>
                                <li>Captura de lead desde formulario web</li>
                                <li>Asignación automática o manual</li>
                                <li>Seguimiento con recordatorios</li>
                                <li>Calificación y scoring</li>
                                <li>Conversión a contacto/entidad</li>
                                <li>Análisis de métricas</li>
                            </ol>
                        </div>
                    </div>

                    <div class="use-case-card">
                        <h4>2. Campañas de Marketing Multi-Canal</h4>
                        <div class="use-case-content">
                            <h5>Flujo:</h5>
                            <ol>
                                <li>Segmentación de audiencia</li>
                                <li>Creación de plantillas</li>
                                <li>Programación de envíos</li>
                                <li>Automatización de respuestas</li>
                                <li>Seguimiento de engagement</li>
                                <li>Optimización basada en métricas</li>
                            </ol>
                        </div>
                    </div>

                    <div class="use-case-card">
                        <h4>3. Gestión de Eventos Corporativos</h4>
                        <div class="use-case-content">
                            <h5>Flujo:</h5>
                            <ol>
                                <li>Creación del evento</li>
                                <li>Gestión de invitados</li>
                                <li>Control de presupuesto</li>
                                <li>Asignación de tareas</li>
                                <li>Seguimiento de asistencia</li>
                                <li>Análisis post-evento</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <div class="code-examples">
                    <h3>💻 Ejemplos de Código</h3>
                    
                    <div class="example-card">
                        <h4>Crear Lead con Notas</h4>
                        <pre><code class="language-typescript">const CREATE_LEAD_WITH_NOTE = gql`
  mutation CreateLeadWithNote($lead: CRM_LeadInput!, $note: CRM_NoteInput!) {
    createCRMLead(lead: $lead) {
      _id
      name
      email
      status
    }
    addCRMLeadNote(leadId: $lead._id, note: $note) {
      _id
      content
      createdAt
    }
  }
`;

const CreateLead: React.FC = () => {
  const [createLead] = useMutation(CREATE_LEAD_WITH_NOTE);

  const handleSubmit = async (values: any) => {
    try {
      const result = await createLead({
        variables: {
          lead: {
            name: values.name,
            email: values.email,
            phone: values.phone,
            company: values.company,
            source: values.source,
            status: 'new',
            value: parseFloat(values.value),
            probability: 0.1
          },
          note: {
            content: values.notes,
            type: 'initial_contact'
          }
        }
      });
      
      // Manejar éxito
    } catch (error) {
      // Manejar error
    }
  };

  return (
    <Formik
      initialValues={{
        name: '',
        email: '',
        phone: '',
        company: '',
        source: '',
        value: '',
        notes: ''
      }}
      onSubmit={handleSubmit}
    >
      {/* Formulario */}
    </Formik>
  );
};</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Deployment Section -->
        <section id="deployment" class="section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-rocket"></i>
                    Despliegue y Configuración
                </h2>

                <div class="deployment-overview">
                    <h3>🚀 Configuración de Producción</h3>
                    
                    <div class="env-config">
                        <h4>Variables de Entorno</h4>
                        <pre><code class="language-bash"># API Configuration
GRAPHQL_PORT=4000
MCP_PORT=4001

# Database
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/crm_production

# Firebase
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_PRIVATE_KEY=your-private-key
FIREBASE_CLIENT_EMAIL=your-client-email

# JWT
JWT_SECRET=your-super-secret-jwt-key

# External Services
WHATSAPP_API_KEY=your-whatsapp-api-key
EMAIL_SERVICE_API_KEY=your-email-service-key

# Security
CORS_ORIGIN=https://yourdomain.com
RATE_LIMIT_WINDOW=15m
RATE_LIMIT_MAX=100</code></pre>
                    </div>

                    <div class="nginx-config">
                        <h4>Configuración Nginx</h4>
                        <pre><code class="language-nginx">server {
    listen 80;
    server_name api2.eventosorganizador.com;
    
    location /graphql {
        proxy_pass http://localhost:4000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    location /mcp {
        proxy_pass http://localhost:4001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}</code></pre>
                    </div>
                </div>

                <div class="monitoring">
                    <h3>📊 Monitoreo y Logs</h3>
                    
                    <div class="monitoring-tools">
                        <h4>Herramientas Recomendadas:</h4>
                        <ul>
                            <li><strong>Health Checks</strong> - Endpoints de estado de la API</li>
                            <li><strong>Logs Estructurados</strong> - Winston + Morgan</li>
                            <li><strong>Métricas</strong> - Prometheus + Grafana</li>
                            <li><strong>Alertas</strong> - Notificaciones automáticas</li>
                            <li><strong>Backup</strong> - Respaldo automático de MongoDB</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Estado de Servicios y Monitoreo -->
        <section id="monitoring" class="section">
            <div class="container">
                <div class="section-header">
                    <h3><i class="fas fa-server"></i> 🚀 Estado de Servicios y Monitoreo en Tiempo Real</h3>
                    <p>Información actualizada sobre el estado de todos los servicios del CRM</p>
                </div>
                
                <div class="content-card">
                    <h4>📊 Estado Actual de los Servicios</h4>
                    
                    <div class="services-status">
                        <div class="service-card active">
                            <h5><i class="fas fa-check-circle"></i> API GraphQL - Producción</h5>
                            <div class="service-details">
                                <p><strong>Estado:</strong> <span class="status-active">🟢 ACTIVO</span></p>
                                <p><strong>Puerto:</strong> 4000</p>
                                <p><strong>Endpoint:</strong> <code>https://api2.eventosorganizador.com/graphql</code></p>
                                <p><strong>Contenedor:</strong> api-prod (UP - 12+ días)</p>
                                <p><strong>Uptime:</strong> 12+ días</p>
                            </div>
                        </div>

                        <div class="service-card active">
                            <h5><i class="fas fa-check-circle"></i> Servicio MCP - Producción</h5>
                            <div class="service-details">
                                <p><strong>Estado:</strong> <span class="status-active">🟢 ACTIVO</span></p>
                                <p><strong>Puerto:</strong> 4001</p>
                                <p><strong>Endpoint:</strong> <code>https://api2.eventosorganizador.com/tools</code></p>
                                <p><strong>Proceso:</strong> Node.js (PID: 1850177)</p>
                                <p><strong>Herramientas:</strong> 25+ disponibles</p>
                            </div>
                        </div>

                        <div class="service-card active">
                            <h5><i class="fas fa-check-circle"></i> API GraphQL - Test</h5>
                            <div class="service-details">
                                <p><strong>Estado:</strong> <span class="status-active">🟢 ACTIVO</span></p>
                                <p><strong>Puerto:</strong> 3000</p>
                                <p><strong>Endpoint:</strong> <code>https://testapi2.eventosorganizador.com/graphql</code></p>
                                <p><strong>Contenedor:</strong> api-test (UP - 8+ días)</p>
                                <p><strong>Uptime:</strong> 8+ días</p>
                            </div>
                        </div>
                    </div>

                    <h4>🔍 Endpoints de Monitoreo Disponibles</h4>
                    <div class="monitoring-endpoints">
                        <div class="endpoint-grid">
                            <div class="endpoint-card">
                                <h6><i class="fas fa-heartbeat"></i> Health Checks</h6>
                                <ul>
                                    <li><strong>API Producción:</strong> <code>https://api2.eventosorganizador.com/health</code></li>
                                    <li><strong>MCP Producción:</strong> <code>https://api2.eventosorganizador.com/mcp/health</code></li>
                                    <li><strong>API Test:</strong> <code>https://testapi2.eventosorganizador.com/health</code></li>
                                </ul>
                            </div>

                            <div class="endpoint-card">
                                <h6><i class="fas fa-tools"></i> Herramientas MCP</h6>
                                <ul>
                                    <li><strong>Lista de Herramientas:</strong> <code>https://api2.eventosorganizador.com/tools</code></li>
                                    <li><strong>SSE Endpoint:</strong> <code>https://api2.eventosorganizador.com/sse</code></li>
                                    <li><strong>MCP TCP:</strong> <code>https://api2.eventosorganizador.com/mcp-tcp</code></li>
                                </ul>
                            </div>

                            <div class="endpoint-card">
                                <h6><i class="fas fa-database"></i> Base de Datos</h6>
                                <ul>
                                    <li><strong>MongoDB Atlas:</strong> Conectado y funcionando</li>
                                    <li><strong>Base Producción:</strong> api-directorio-bodas</li>
                                    <li><strong>Base Test:</strong> prueba1</li>
                                    <li><strong>Estado:</strong> 🟢 Conectado</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h4>⚡ Comandos de Monitoreo en Tiempo Real</h4>
                    <div class="monitoring-commands">
                        <div class="command-section">
                            <h6>🔍 Verificar Estado de Servicios</h6>
                            <pre><code class="language-bash"># Verificar puertos activos
netstat -tlnp | grep -E ":(3000|4000|4001)"

# Verificar contenedores Docker
docker ps -a | grep -E "(api-prod|api-test|mcp)"

# Verificar procesos Node.js
ps aux | grep -E "(node|npm|ts-node)" | grep -v grep

# Verificar logs de servicios
tail -f mcp-express.log
docker logs api-prod --tail 20
docker logs api-test --tail 20</code></pre>
                        </div>

                        <div class="command-section">
                            <h6>🚀 Reiniciar Servicios</h6>
                            <pre><code class="language-bash"># Reiniciar servicio MCP
kill $(ps aux | grep "start-mcp-express" | grep -v grep | awk '{print $2}')
nohup node ./dist-express/start-mcp-express.js > mcp-express.log 2>&1 &

# Reiniciar contenedores Docker
docker restart api-prod
docker restart api-test

# Recargar configuración Nginx
systemctl reload nginx</code></pre>
                        </div>

                        <div class="command-section">
                            <h6>📊 Verificar Logs y Errores</h6>
                            <pre><code class="language-bash"># Logs de Nginx
tail -f /var/log/nginx/api2.error.log
tail -f /var/log/nginx/api2.access.log

# Logs de servicios
tail -f mcp-express.log
tail -f combined.log
tail -f error.log

# Verificar configuración Nginx
nginx -t
cat /etc/nginx/sites-available/api2.eventosorganizador.com</code></pre>
                        </div>
                    </div>

                    <h4>🔄 Flujo de Monitoreo Automático</h4>
                    <div class="monitoring-flow">
                        <div class="flow-diagram">
                            <pre><code class="language-text">┌─────────────────────────────────────────────────────────────────┐
│                SISTEMA DE MONITOREO AUTOMÁTICO                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐ │
│  │   HEALTH CHECK  │    │   LOG MONITOR   │    │   ALERTAS   │ │
│  │   CADA 5 MIN    │───▶│   EN TIEMPO     │───▶│   AUTOMÁTICAS│ │
│  └─────────────────┘    │   REAL          │    └─────────────┘ │
│           │                       │                    │        │
│           │                       │                    │        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐ │
│  │   MÉTRICAS      │    │   PERFORMANCE   │    │   BACKUP    │ │
│  │   EN TIEMPO     │    │   MONITORING    │    │   AUTOMÁTICO│ │
│  │   REAL          │    │                 │    │             │ │
│  └─────────────────┘    └─────────────────┘    └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘</code></pre>
                        </div>

                        <div class="monitoring-features">
                            <h6>✅ Características del Sistema de Monitoreo</h6>
                            <ul>
                                <li><strong>Health Checks Automáticos:</strong> Verificación cada 5 minutos</li>
                                <li><strong>Logs Estructurados:</strong> Winston + Morgan para logging</li>
                                <li><strong>Métricas en Tiempo Real:</strong> Prometheus + Grafana</li>
                                <li><strong>Alertas Automáticas:</strong> Notificaciones por email/Slack</li>
                                <li><strong>Backup Automático:</strong> MongoDB Atlas + respaldo local</li>
                                <li><strong>Uptime Monitoring:</strong> Seguimiento de disponibilidad</li>
                                <li><strong>Performance Metrics:</strong> Latencia, throughput, errores</li>
                            </ul>
                        </div>
                    </div>

                    <h4>🎯 Próximos Pasos para Monitoreo</h4>
                    <div class="next-steps-monitoring">
                        <div class="step-card">
                            <h6><i class="fas fa-robot"></i> 1. Automatización de Health Checks</h6>
                            <p>Implementar cron jobs para verificación automática de servicios</p>
                        </div>
                        
                        <div class="step-card">
                            <h6><i class="fas fa-chart-line"></i> 2. Dashboard de Métricas</h6>
                            <p>Crear panel de control con Grafana para visualización de métricas</p>
                        </div>
                        
                        <div class="step-card">
                            <h6><i class="fas fa-bell"></i> 3. Sistema de Alertas</h6>
                            <p>Configurar notificaciones automáticas para fallos de servicios</p>
                        </div>
                        
                        <div class="step-card">
                            <h6><i class="fas fa-database"></i> 4. Monitoreo de Base de Datos</h6>
                            <p>Implementar métricas de MongoDB Atlas y alertas de rendimiento</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sistema de Monitoreo y Alertas Detallado -->
        <section id="monitoring-detailed" class="section">
            <div class="container">
                <div class="section-header">
                    <h3><i class="fas fa-bell"></i> 🔔 Sistema de Monitoreo y Alertas Detallado</h3>
                    <p>Guía completa del sistema de monitoreo automático y alertas por email</p>
                </div>
                
                <div class="content-card">
                    <h4>📊 ¿Cómo Funciona el Monitoreo Automático?</h4>
                    
                    <div class="monitoring-explanation">
                        <div class="explanation-grid">
                            <div class="explanation-card">
                                <h6><i class="fas fa-clock"></i> Monitoreo Cada 5 Minutos</h6>
                                <p>El sistema verifica automáticamente:</p>
                                <ul>
                                    <li>✅ Puertos activos (3000, 3001, 4000, 4001)</li>
                                    <li>✅ Contenedores Docker (api-prod, api-test)</li>
                                    <li>✅ Procesos Node.js (servicios MCP)</li>
                                    <li>✅ Endpoints HTTP (health checks)</li>
                                    <li>✅ Recursos del sistema (CPU, memoria, disco)</li>
                                </ul>
                            </div>

                            <div class="explanation-card">
                                <h6><i class="fas fa-file-alt"></i> Logs Automáticos</h6>
                                <p>Se generan logs con timestamp:</p>
                                <ul>
                                    <li>📋 <code>crm-status-YYYYMMDD.log</code> - Estado diario</li>
                                    <li>🚨 <code>crm-alerts-YYYYMMDD.log</code> - Alertas (si las hay)</li>
                                    <li>❌ <code>crm-errors-YYYYMMDD.log</code> - Errores (si los hay)</li>
                                </ul>
                            </div>

                            <div class="explanation-card">
                                <h6><i class="fas fa-robot"></i> Cron Jobs Activos</h6>
                                <p>Tareas programadas automáticas:</p>
                                <ul>
                                    <li>⏰ <strong>Cada 5 min:</strong> Verificación de servicios</li>
                                    <li>📧 <strong>Cada hora:</strong> Envío de alertas por email</li>
                                    <li>🧹 <strong>Diario 2:00 AM:</strong> Limpieza de logs</li>
                                    <li>💾 <strong>Semanal 3:00 AM:</strong> Backup de logs</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h4>📧 Sistema de Alertas por Email con Brevo SMTP</h4>
                    
                    <div class="email-alerts-section">
                        <div class="alert-config">
                            <h6><i class="fas fa-envelope"></i> Configuración de Email</h6>
                            <p><strong>Email de destino:</strong> <code>bodasdehoy.com@gmail.com</code></p>
                            <p><strong>Servidor SMTP:</strong> <code>smtp-relay.brevo.com:587</code></p>
                            <p><strong>Frecuencia:</strong> Cada hora (solo si hay alertas)</p>
                            <p><strong>Formato:</strong> Email HTML con diseño profesional</p>
                        </div>

                        <div class="alert-triggers">
                            <h6><i class="fas fa-exclamation-triangle"></i> ¿Cuándo se Envían Alertas?</h6>
                            <ul>
                                <li>🚨 <strong>Servicios caídos:</strong> Puerto inactivo, contenedor caído</li>
                                <li>⚠️ <strong>Recursos críticos:</strong> CPU > 90%, Memoria > 95%, Disco > 90%</li>
                                <li>❌ <strong>Endpoints no responden:</strong> Health checks fallidos</li>
                                <li>🔴 <strong>Procesos muertos:</strong> Node.js no responde</li>
                            </ul>
                        </div>

                        <div class="email-example">
                            <h6><i class="fas fa-eye"></i> Ejemplo de Email de Alerta</h6>
                            <div class="email-preview">
                                <div class="email-header">
                                    <h4>🚨 ALERTAS CRM - Marketing Soluciones</h4>
                                    <p>Sistema de Monitoreo Automático</p>
                                </div>
                                <div class="email-content">
                                    <p><strong>Servidor:</strong> api2.eventosorganizador.com</p>
                                    <p><strong>Fecha:</strong> 2025-08-26 18:45:00</p>
                                    <p><strong>Total de Alertas:</strong> 2</p>
                                    <div class="alert-item">
                                        🚨 ALERTA: API GraphQL Test (puerto 3000) no responde
                                    </div>
                                    <div class="alert-item">
                                        ⚠️ ALERTA: Uso de CPU crítico: 95%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h4>🛠️ Comandos para Monitoreo Manual</h4>
                    
                    <div class="manual-monitoring">
                        <div class="command-section">
                            <h6><i class="fas fa-terminal"></i> Comandos de Estado</h6>
                            <pre><code class="language-bash"># Estado rápido del sistema
crm-status

# Monitoreo detallado manual
./monitor-services.sh

# Monitoreo continuo (actualiza cada 30 segundos)
./monitor-services.sh -c

# Ver estado de servicios específicos
netstat -tlnp | grep -E ":(3000|3001|4000|4001)"
docker ps -a
ps aux | grep -E "(node|npm)" | grep -v grep</code></pre>
                        </div>

                        <div class="command-section">
                            <h6><i class="fas fa-file-alt"></i> Comandos de Logs</h6>
                            <pre><code class="language-bash"># Ver logs en tiempo real
tail -f /var/log/crm-monitoring/crm-status-$(date +%Y%m%d).log
tail -f /var/log/crm-monitoring/crm-alerts-$(date +%Y%m%d).log

# Ver logs del día
cat /var/log/crm-monitoring/crm-status-$(date +%Y%m%d).log
cat /var/log/crm-monitoring/crm-alerts-$(date +%Y%m%d).log

# Ver todos los logs disponibles
ls -la /var/log/crm-monitoring/</code></pre>
                        </div>

                        <div class="command-section">
                            <h6><i class="fas fa-envelope"></i> Comandos de Email</h6>
                            <pre><code class="language-bash"># Probar sistema de email
test-email-alert.sh

# Enviar alertas manualmente
crm-send-alert-gmail.sh

# Ver configuración de email
cat /etc/ssmtp/ssmtp.conf
cat /etc/ssmtp/revaliases</code></pre>
                        </div>
                    </div>

                    <h4>📁 Estructura de Archivos del Sistema</h4>
                    
                    <div class="file-structure">
                        <div class="structure-tree">
                            <pre><code class="language-text">/var/log/crm-monitoring/
├── crm-status-20250826.log          # Estado diario de servicios
├── crm-alerts-20250826.log          # Alertas generadas (si las hay)
├── crm-errors-20250826.log          # Errores encontrados (si los hay)
└── backup-20250826.tar.gz           # Backup semanal (domingo 3:00 AM)

/usr/local/bin/
├── crm-monitor.sh                   # Script de monitoreo automático
├── crm-send-alert-gmail.sh          # Script de alertas por email
├── crm-status                       # Comando rápido de estado
└── test-email-alert.sh              # Script de prueba de email

/var/www/api-production/
├── monitor-services.sh               # Monitoreo manual detallado
└── setup-gmail-alerts.sh            # Configuración de alertas</code></pre>
                        </div>
                    </div>

                    <h4>🔧 Configuración de Brevo SMTP</h4>
                    
                    <div class="brevo-config">
                        <div class="config-steps">
                            <h6><i class="fas fa-cog"></i> Pasos para Configurar Brevo</h6>
                            <ol>
                                <li><strong>Crear cuenta en Brevo</strong> (anteriormente Sendinblue)</li>
                                <li><strong>Generar clave SMTP</strong> en el panel de control</li>
                                <li><strong>Editar archivo de configuración:</strong> <code>/etc/ssmtp/ssmtp.conf</code></li>
                                <li><strong>Reemplazar:</strong> <code>TU_CONTRASEÑA_DE_BREVO</code> con tu clave SMTP real</li>
                                <li><strong>Probar el sistema:</strong> <code>test-email-alert.sh</code></li>
                            </ol>
                        </div>

                        <div class="config-files">
                            <h6><i class="fas fa-file-code"></i> Archivos de Configuración</h6>
                            <div class="config-file">
                                <h7><code>/etc/ssmtp/ssmtp.conf</code></h7>
                                <pre><code class="language-conf"># Configuración Brevo SMTP para CRM
AuthUser=BODASDEHOY.COM@GMAIL.COM
AuthPass=TU_CONTRASEÑA_DE_BREVO
AuthMethod=LOGIN
mailhub=smtp-relay.brevo.com:587
UseSTARTTLS=YES
UseTLS=YES
FromLineOverride=YES
hostname=api2.eventosorganizador.com</code></pre>
                            </div>
                        </div>
                    </div>

                    <h4>📊 Dashboard de Monitoreo en Tiempo Real</h4>
                    
                    <div class="monitoring-dashboard">
                        <div class="dashboard-features">
                            <h6><i class="fas fa-tachometer-alt"></i> Características del Dashboard</h6>
                            <ul>
                                <li>🟢 <strong>Estado visual:</strong> Verde (OK), Amarillo (Advertencia), Rojo (Crítico)</li>
                                <li>📈 <strong>Métricas en tiempo real:</strong> CPU, memoria, disco, procesos</li>
                                <li>🔍 <strong>Logs en vivo:</strong> Actualización automática cada 5 minutos</li>
                                <li>📧 <strong>Historial de alertas:</strong> Todas las notificaciones enviadas</li>
                                <li>📊 <strong>Estadísticas:</strong> Uptime, servicios activos, errores</li>
                            </ul>
                        </div>

                        <div class="dashboard-commands">
                            <h6><i class="fas fa-keyboard"></i> Comandos del Dashboard</h6>
                            <pre><code class="language-bash"># Dashboard principal
./monitor-services.sh

# Dashboard continuo
./monitor-services.sh -c

# Estado rápido
crm-status

# Ver logs en tiempo real
tail -f /var/log/crm-monitoring/crm-status-$(date +%Y%m%d).log</code></pre>
                        </div>
                    </div>

                    <h4>🎯 Resumen del Sistema de Monitoreo</h4>
                    
                    <div class="monitoring-summary">
                        <div class="summary-grid">
                            <div class="summary-card">
                                <h6><i class="fas fa-check-circle"></i> ✅ Lo que SÍ Funciona</h6>
                                <ul>
                                    <li>Monitoreo automático cada 5 minutos</li>
                                    <li>Logs estructurados con timestamp</li>
                                    <li>Verificación de servicios críticos</li>
                                    <li>Monitoreo de recursos del sistema</li>
                                    <li>Cron jobs automáticos</li>
                                    <li>Scripts de monitoreo manual</li>
                                </ul>
                            </div>

                            <div class="summary-card">
                                <h6><i class="fas fa-cog"></i> ⚙️ Lo que Necesita Configuración</h6>
                                <ul>
                                    <li>Clave SMTP de Brevo</li>
                                    <li>Configuración de archivo ssmtp.conf</li>
                                    <li>Prueba del sistema de email</li>
                                    <li>Verificación de envío de alertas</li>
                                </ul>
                            </div>

                            <div class="summary-card">
                                <h6><i class="fas fa-rocket"></i> 🚀 Próximas Mejoras</h6>
                                <ul>
                                    <li>Dashboard web con interfaz gráfica</li>
                                    <li>Alertas por Slack/Telegram</li>
                                    <li>Métricas con Prometheus + Grafana</li>
                                    <li>Notificaciones push móviles</li>
                                    <li>Reportes automáticos diarios</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Marketing Soluciones</h3>
                    <p>Sistema CRM completo para gestión de relaciones con clientes</p>
                </div>
                <div class="footer-section">
                    <h3>Enlaces Útiles</h3>
                    <ul>
                        <li><a href="https://github.com/carlos2325/crm-documentation">Repositorio</a></li>
                        <li><a href="https://carlos2325.github.io/crm-documentation/">Documentación</a></li>
                        <li><a href="https://api2.eventosorganizador.com/">API Production</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contacto</h3>
                    <p>Equipo de Desarrollo</p>
                    <p>Marketing Soluciones</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Marketing Soluciones. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button -->
    <button id="scroll-top" class="scroll-top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="assets/js/main.js"></script>
</body>
</html>
